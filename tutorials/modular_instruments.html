<!DOCTYPE html>
<html
	data-bs-theme="auto"
>
	<head>
		<meta charset="utf-8">

		<title>Modular SFZ Instruments - SFZ Format</title>

		<meta name="author" content="Karoryfer Samples and SFZ Format Team">
		<meta name="web-author" content="RedTide and SFZ Format Team">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<script src="/assets/js/color-modes.js"></script>

		<!-- Atom Feeds -->
		<link href="/atom.xml" rel="alternate" type="application/atom+xml" />

		<!-- Favicon Generator Icons -->
		<link rel="apple-touch-icon" sizes="152x152" href="/assets/ico/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/assets/ico/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/assets/ico/favicon-16x16.png">
		<link rel="manifest" href="/assets/ico/site.webmanifest">
		<link rel="mask-icon" href="/assets/ico/safari-pinned-tab.svg" color="#5bbad5">
		<link rel="shortcut icon" href="/assets/ico/favicon.ico">
		<meta name="msapplication-TileColor" content="#da532c">
		<meta name="msapplication-config" content="/assets/ico/browserconfig.xml">
		<meta name="theme-color" content="#ffffff">

		<!-- Stylesheets -->
		<link href="/assets/css/style.min.css" rel="stylesheet" media="screen">
		<link
			href="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.css"
			rel="stylesheet"
		>
	<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/github.min.css"
			disabled="disabled"
			id="hljs_light"
		/>
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/github-dark-dimmed.min.css"
			disabled="disabled"
			id="hljs_dark"
		/>

		<!-- Font Awesome Icons -->
		<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/solid.js"       integrity="sha384-Mf3ap7OwO+bjTkzM1RsrothLh38uKXvMWJ2TQPXGHqZcqfeI/cyCV+sfV0IDnBDq" crossorigin="anonymous"></script>
		<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/brands.js"      integrity="sha384-b2GpqFrJizV0BUEdbrITdOA5HnxnlrErt7MlEERWd6NSJ32rHeibEvyyCuA13OAS" crossorigin="anonymous"></script>
		<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/fontawesome.js" integrity="sha384-EYYaHDhIRoBhd/Ir/1fPnxg9rZLk/55lKtlNT5KrIcONoCS2kjf7ZWzMoCLLACeo" crossorigin="anonymous"></script>

	</head>

	<body>

		<button onclick="topFunction()" id="scrollButton" title="Go to top">Top</button>
		<div class="container">


			<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
				<symbol id="sun-fill" viewBox="0 0 16 16">
					<path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
				</symbol>
				<symbol id="moon-stars-fill" viewBox="0 0 16 16">
					<path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
					<path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
				</symbol>
				<symbol id="circle-half" viewBox="0 0 16 16">
					<path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
				</symbol>
				<symbol id="check2" viewBox="0 0 16 16">
					<path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
				</symbol>
			</svg>

			<nav
				class="navbar navbar-expand-lg bg-dark" text-bg-dark
				data-bs-theme="dark"
			>
				<div class="container">

					<button
						class="navbar-toggler"
						type="button"
						data-bs-toggle="collapse"
						data-bs-target="#navbarContent"
						aria-controls="navbarContent"
						aria-expanded="false"
						aria-label="Toggle navigation"
					>
						<span class="navbar-toggler-icon"></span>
					</button>

					<a
						class="navbar-brand"
						href="/"
					>
						<img
							src="/assets/img/logo.png"
							width="120" height="30" class="d-inline-block align-top" alt=""
						/></a>

					<div class="collapse navbar-collapse" id="navbarContent">
						<ul class="navbar-nav me-auto mt-2 mt-lg-0">
								
							<li class="nav-item dropdown">
								<a
									class="nav-link dropdown-toggle"
									href="#"
									id="navbarSyntax"
									role="button"
									data-bs-toggle="dropdown"
									aria-expanded="false"
									aria-haspopup="true"
								>Syntax
								</a>
								<ul
									class="dropdown-menu"
									aria-labelledby="navbarSyntax"
								>
									<li>
										<a class="dropdown-item"
											href="/headers/"
										>
											Headers
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/opcodes/"
										>
											Opcodes
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/modulations/"
										>
											Modulations
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/modulations/envelope_generators"
										>
											Envelope Generators
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/modulations/lfo"
										>
											LFO
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/extensions/midi_ccs"
										>
											Extended MIDI CCs
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/misc/categories"
										>
											Types & Categories
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/versions"
										>
											Versions
										</a>
									</li>
								</ul>
							</li>
								
							<li class="nav-item dropdown">
								<a
									class="nav-link dropdown-toggle"
									href="#"
									id="navbarSoftware"
									role="button"
									data-bs-toggle="dropdown"
									aria-expanded="false"
									aria-haspopup="true"
								>Software
								</a>
								<ul
									class="dropdown-menu"
									aria-labelledby="navbarSoftware"
								>
									<li>
										<a class="dropdown-item"
											href="/software/players"
										>
											Players
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/software/tools"
										>
											Tools
										</a>
									</li>
								</ul>
							</li>
								
							<li class="nav-item dropdown">
								<a
									class="nav-link dropdown-toggle"
									href="#"
									id="navbarTutorials"
									role="button"
									data-bs-toggle="dropdown"
									aria-expanded="false"
									aria-haspopup="true"
								>Tutorials
								</a>
								<ul
									class="dropdown-menu"
									aria-labelledby="navbarTutorials"
								>
									<li>
										<a class="dropdown-item"
											href="/tutorials/basics"
										>
											Basics
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/basic_sfz_file"
										>
											Basic / Template
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/sustained_note_basics"
										>
											Sustained Note Basics
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/vibrato"
										>
											Vibrato
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/legato"
										>
											Legato
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/unison"
										>
											Unison
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/range_extension"
										>
											Range Extension
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/modular_instruments"
										>
											Modular Instruments
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/subtractive_synths"
										>
											Subtractive Synthesizers
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/strum"
										>
											Strumming
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/drum_basics"
										>
											Drum & Round Robin Basics
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/cymbal_muting"
										>
											Cymbal Muting
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/epic_drums"
										>
											Epic Drums
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/brush_stirs"
										>
											Brush Stirs
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/envelope_generators"
										>
											Envelope Generators
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/sfz1_modulations"
										>
											SFZ 1 Modulations
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/sfz2_modulations"
										>
											SFZ 2 Modulations
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/lfo"
										>
											Pitch LFO Examples
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/videos"
										>
											Video Tutorials
										</a>
									</li>
								</ul>
							</li>
							<li class="nav-item">
								<a
									class="nav-link"
									href="https://sfzinstruments.github.io"
								>
									Instruments
								</a>
							</li>
							<li class="nav-item">
								<a
									class="nav-link"
									href="/news"
								>
									News
								</a>
							</li>
						</ul>
						<ul class="navbar-nav">
							<li class="nav-item">
								<a class="nav-link"
									href="/search/">
									Search</a>
							</li>
							<li class="nav-item dropdown">
								<button
									class="btn btn-link nav-link py-2 px-0 px-lg-2 dropdown-toggle d-flex align-items-center"
									id="bd-theme"
									type="button"
									aria-expanded="false"
									data-bs-toggle="dropdown"
									data-bs-display="static"
									aria-label="Toggle theme (auto)">
									<svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg>
									<span class="d-lg-none ms-2" id="bd-theme-text">Toggle theme</span>
								</button>
								<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
									<li>
										<button
											type="button"
											class="dropdown-item d-flex align-items-center"
											data-bs-theme-value="light"
											aria-pressed="false">
											<svg class="bi me-2 opacity-50 theme-icon"><use href="#sun-fill"></use></svg>
											Light
											<svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
										</button>
									</li>
									<li>
										<button
											type="button"
											class="dropdown-item d-flex align-items-center"
											data-bs-theme-value="dark"
											aria-pressed="false">
											<svg class="bi me-2 opacity-50 theme-icon"><use href="#moon-stars-fill"></use></svg>
											Dark
											<svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
										</button>
									</li>
									<li>
										<button
											type="button"
											class="dropdown-item d-flex align-items-center active"
											data-bs-theme-value="auto"
											aria-pressed="true">
											<svg class="bi me-2 opacity-50 theme-icon"><use href="#circle-half"></use></svg>
											Auto
											<svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
										</button>
									</li>
								</ul>
							</li>
						</ul>
					</div>
				</div>
			</nav>

			<div class="row mt-4" id="content">
				<div class="col-md-9">
					<article><h1>Modular SFZ Instruments</h1><h2 id="the-include-statement">
        
        
          The Include Statement <a href="#the-include-statement" class="toc-anchor">#</a>
        
        
      </h2>

<p>SFZ is not a programming language, and has a structure based on a hierarchy of headers. There are no procedure or function calls which would allow the same block of code to be called from various places in an SFZ file. This can lead to a lot of repetition in large SFZ instruments. As a simple example, here’s a polyphony switch in an instrument causing duplication of the sample map.</p>

<pre><code>&lt;group&gt;
hicc100=63
&lt;region&gt;key=48 sample=c4.wav
&lt;region&gt;key=49 sample=db4.wav
&lt;region&gt;key=50 sample=d4.wav
&lt;region&gt;key=51 sample=eb4.wav
&lt;region&gt;key=52 sample=e4.wav
&lt;region&gt;key=53 sample=f4.wav
&lt;region&gt;key=54 sample=gb4.wav
&lt;region&gt;key=55 sample=g4.wav
&lt;region&gt;key=56 sample=ab4.wav
&lt;region&gt;key=57 sample=a4.wav
&lt;region&gt;key=58 sample=bb4.wav
&lt;region&gt;key=59 sample=b4.wav
&lt;region&gt;key=60 sample=c5.wav

&lt;group&gt;
locc100=64
group=1
off_by=1
&lt;region&gt;key=48 sample=c4.wav
&lt;region&gt;key=49 sample=db4.wav
&lt;region&gt;key=50 sample=d4.wav
&lt;region&gt;key=51 sample=eb4.wav
&lt;region&gt;key=52 sample=e4.wav
&lt;region&gt;key=53 sample=f4.wav
&lt;region&gt;key=54 sample=gb4.wav
&lt;region&gt;key=55 sample=g4.wav
&lt;region&gt;key=56 sample=ab4.wav
&lt;region&gt;key=57 sample=a4.wav
&lt;region&gt;key=58 sample=bb4.wav
&lt;region&gt;key=59 sample=b4.wav
&lt;region&gt;key=60 sample=c5.wav
</code></pre>

<p>If we create an SFZ file called sample_map.sfz with the following content:</p>

<pre><code>&lt;region&gt;key=48 sample=c4.wav
&lt;region&gt;key=49 sample=db4.wav
&lt;region&gt;key=50 sample=d4.wav
&lt;region&gt;key=51 sample=eb4.wav
&lt;region&gt;key=52 sample=e4.wav
&lt;region&gt;key=53 sample=f4.wav
&lt;region&gt;key=54 sample=gb4.wav
&lt;region&gt;key=55 sample=g4.wav
&lt;region&gt;key=56 sample=ab4.wav
&lt;region&gt;key=57 sample=a4.wav
&lt;region&gt;key=58 sample=bb4.wav
&lt;region&gt;key=59 sample=b4.wav
&lt;region&gt;key=60 sample=c5.wav
</code></pre>

<p>Then the sample map becomes a reusable module which can be “called” using
an <a href="/opcodes/include">#include</a> statement.
The instrument can be decluttered to this:</p>

<pre><code>&lt;group&gt;
hicc100=63
#include "sample_map.sfz"

&lt;group&gt;
locc100=64
group=1
off_by=1
#include "sample_map.sfz"
</code></pre>
    
      <h2 id="include-and-file-paths">
        
        
          Include And File Paths <a href="#include-and-file-paths" class="toc-anchor">#</a>
        
        
      </h2>

<p>With large instruments which would be broken down into many files, the included files can be placed in a different
folder or in a subfolder of the folder containing the instruments. Regardless of which file folder the included
files are in, the sample file paths and include file paths will be calculated starting with the folder which contains
the instrument file.</p>

<p>So, if our above example instrument has the main SFZ file, called main.sfz, in a Programs folder under the instrument
root, samples in a Samples folder under that, and the sample_map.sfz is in Programs/mappings, then main.sfz should contain:</p>

<pre><code>&lt;group&gt;
hicc100=63
#include "mappings/sample_map.sfz"

&lt;group&gt;
locc100=64
group=1
off_by=1
#include "mappings/sample_map.sfz"
</code></pre>

<p>The sample_map.sfz file in mappings should have the following contents:</p>

<pre><code>&lt;region&gt;key=48 sample=../Samples/c4.wav
&lt;region&gt;key=49 sample=../Samples/db4.wav
&lt;region&gt;key=50 sample=../Samples/d4.wav
&lt;region&gt;key=51 sample=../Samples/eb4.wav
&lt;region&gt;key=52 sample=../Samples/e4.wav
&lt;region&gt;key=53 sample=../Samples/f4.wav
&lt;region&gt;key=54 sample=../Samples/gb4.wav
&lt;region&gt;key=55 sample=../Samples/g4.wav
&lt;region&gt;key=56 sample=../Samples/ab4.wav
&lt;region&gt;key=57 sample=../Samples/a4.wav
&lt;region&gt;key=58 sample=../Samples/bb4.wav
&lt;region&gt;key=59 sample=../Samples/b4.wav
&lt;region&gt;key=60 sample=../Samples/c5.wav
</code></pre>

<p>This means that opening the main.sfz file will work, but trying to open sample_map.sfz directly would not, as it would
try to locate the samples in a relative path of ../Samples, which exists when starting from Programs, but does not exist
when starting from Programs/modules. This can make testing sample maps somewhat messy, as they need to be moved out of
their “proper” folder if the map needs to be tested by itself, without the rest of the SFZ.</p>
    
      <h2 id="include-and-nesting">
        
        
          Include And Nesting <a href="#include-and-nesting" class="toc-anchor">#</a>
        
        
      </h2>

<p>Included files can, themselves, include files. This is not a problem, just avoid circular recursion.</p>
    
      <h2 id="other-use-cases-for-include">
        
        
          Other Use Cases For Include <a href="#other-use-cases-for-include" class="toc-anchor">#</a>
        
        
      </h2>

<p>In addition to sample maps, modulations can also be reused. For example, a common set of vibrato controls can be included
for violin samples which need them, but left out for samples which don’t, such as harmonics, percussive noises and legato
transitions. Different dynamics controls for long vs. short bowed articulations are also candidates for such treatment.</p>

<pre><code>&lt;master&gt;
sw_last=34
sw_label=Sustain
#include "modules/vibrato.sfz"
#include "modules/long_dynamics.sfz"
#include "mappings/sustain.sfz"

&lt;master&gt;
sw_last=33
sw_label=Staccato
#include "modules/vibrato.sfz"
#include "modules/short_dynamics.sfz"
#include "mappings/staccato.sfz"

&lt;master&gt;
sw_last=32
sw_label=Natural harmonics
#include "modules/long_dynamics.sfz"
#include "mappings/harmonics.sfz"

&lt;master&gt;
sw_last=31
sw_label=Percussive noises
#include "modules/short_dynamics.sfz"
#include "mappings/noises.sfz"
</code></pre>

<p>The same file can also be included in multiple instruments, for example a violin spiccato articulation map can
be used in both a spiccato-only instrument and in a keyswitch instrument which contains other articulations as
well.</p>

<p>Putting each set of round robins inside its own file without defining <a href="/opcodes/seq_position">seq_position</a>
inside that file can also be useful for emulating double-tracking.
If the basic non-doubletracked instrument is set up like this:</p>

<pre><code>&lt;global&gt;
seq_length=4

&lt;group&gt;
seq_position=1
#include "mappings/palm_mute_rr1_map.sfz"
&lt;group&gt;
seq_position=2
#include "mappings/palm_mute_rr2_map.sfz"
&lt;group&gt;
seq_position=3
#include "mappings/palm_mute_rr3_map.sfz"
&lt;group&gt;
seq_position=4
#include "mappings/palm_mute_rr4_map.sfz"
</code></pre>

<p>It then becomes very simple to make a doubletracked instrument which uses differnt round robins in the left and right channels:</p>

<pre><code>&lt;global&gt;
seq_length=4

&lt;group&gt;
pan=100
seq_position=1
#include "mappings/palm_mute_rr1_map.sfz"
&lt;group&gt;
pan=100
seq_position=2
#include "mappings/palm_mute_rr2_map.sfz"
&lt;group&gt;
pan=100
seq_position=3
#include "mappings/palm_mute_rr3_map.sfz"
&lt;group&gt;
pan=100
seq_position=4
#include "mappings/palm_mute_rr4_map.sfz"

&lt;group&gt;
pan=-100
seq_position=1
#include "mappings/palm_mute_rr2_map.sfz"
&lt;group&gt;
pan=-100
seq_position=2
#include "mappings/palm_mute_rr3_map.sfz"
&lt;group&gt;
pan=-100
seq_position=3
#include "mappings/palm_mute_rr4_map.sfz"
&lt;group&gt;
pan=-100
seq_position=4
#include "mappings/palm_mute_rr1_map.sfz"
</code></pre>
    
      <h2 id="include-and-headers">
        
        
          Include And Headers <a href="#include-and-headers" class="toc-anchor">#</a>
        
        
      </h2>

<p>When including files, it’s common to put lower levels of <a href="/headers/">header</a> organization,
such as region and group in the included file, and put higher levels in the main file.
However, this is not necessary, and any levels of headers can be included.
It is important to keep in mind that included files are essentially just concatenated to make the SFZ file which
the SFZ instrument actually parses. Although an included file is a little like a procedure in a programming language, it
isn’t really one, and the end of the included file is not meaningful when</p>

<p>SFZ opcodes set under headers within an included file will be in effect until encountering another header of the same or
higher level. For example, let’s say a snare drum sample map contains one-shot samples under <code>&lt;region&gt;</code> headers and also
multisampled hits under a <code>&lt;group&gt;</code> header later in the file, and this file is called snare_map.sfz.</p>

<pre><code>&lt;region&gt;
key=37
sample=Sidestick.wav
&lt;region&gt;
key=39
sample=Off_center.wav
&lt;region&gt;
key=40
sample=Rimshot.wav
&lt;group&gt;
key=38
seq_length=4
&lt;region&gt;
seq_position=1
sample=Center_rr1.wav
&lt;region&gt;
seq_position=2
sample=Center_rr2.wav
&lt;region&gt;
seq_position=3
sample=Center_rr3.wav
&lt;region&gt;
seq_position=4
sample=Center_rr4.wav
</code></pre>

<p>If we want to put snare controls which apply to all those, this would work:</p>

<pre><code>&lt;master&gt;
amplitude_oncc100=100
tune_oncc101=1200
tune_curvecc101=1
#include "snare_map.sfz"
</code></pre>

<p>This, however, would make the controls affect the sidesticks, off-center hits and rimshot, but not the center hits:</p>

<pre><code>&lt;group&gt;
amplitude_oncc100=100
tune_oncc101=1200
tune_curvecc101=1
#include "snare_map.sfz"
</code></pre>

<p>That is because the opcodes set under the <code>&lt;group&gt;</code> header would only be active until the <code>&lt;group&gt;</code> header for the center
hits is reached. If a <code>&lt;master&gt;</code> header is used, they remain in force until another <code>&lt;master&gt;</code> header is encountered. When
the headers are not immediately visible because they’re in an included file, it is easy to fall into this kind of trap.</p>
    
      <h2 id="the-define-statement">
        
        
          The Define Statement <a href="#the-define-statement" class="toc-anchor">#</a>
        
        
      </h2>

<p>In addition to include, <a href="/opcodes/define">#define</a> is the other statement which is very useful
in making instruments more modular.</p>

<p>Define and include can be used together. For example, user-editable parameters, such as MIDI note assignments for drum kits
and CC ranges, can also be placed in a separate file such as the below.</p>

<pre><code>#define $KICKKEY 36
#define $SIDESTICKKEY 37
#define $SNAREKEY 38
</code></pre>

<p>The defined variables can then be used throughout the instrument, and an end user who wants to change the keymap can edit the
file containing the defined numbers without having to search through the entire instrument. In the specific implementation of ARIA,
anything which uses the defined variables also needs to be placed in the main SFZ file using include, because of the way ARIA
parses SFZ files, described in more detail under the opcode page.</p>

<p>Using define as a constant with a single value thorughout an instrument works easily. Defining the same variable to have multiple
values at different points in the same instrument, however, requires care. Using #define to set the same variable to different
values at one point in the same SFZ file does not work well at least in ARIA/Sforzando when loading an instrument. However, a
workaround there is to use include to put each set of define statements with different values in a separate file. In simple
tests, that has been successful.</p>

<p>Sometimes copying large chunks of SFZ code and performing search-replace within them is easier than redefining variables comes into
play. There’s a balance of when to use include statements and when to just copy some files and use search-replace.</p>

<p>Multiple defined variables can be used in the same line.</p>

<pre><code>#define $MIC_NAME Room
#define $MIC_MIX_CC 32
&lt;control&gt;
label_cc$MIC_MIX_CC=$MIC_NAME
</code></pre>
<p>One thing to keep in mind is that each variable name should be unique. This is good:</p>

<pre><code>#define $SNARE_KEY 38
#define $SNARE_RIMSHOT_KEY 40
</code></pre>

<p>This will fail in at least some SFZ players, because the complete name of one variable is also the start of another variable’s name:</p>

<pre><code>#define $SNARE 38
#define $SNARE_RIMSHOT 40
</code></pre>
					</article>
				</div>
				<div class="col-md-3">
					<aside>

	
						<div class="card mb-3">
							<div class="card-header bg-dark text-bg-dark">
								<i class="fas fa-eye"
									aria-hidden="true"></i>
								Follow us
							</div>
							<div class="card-body" style="padding: 0.5rem">
								<ul class="nav nav-pills flex-column">
									<li class="nav-item">
										<a class="nav-link" href="https://discord.gg/t7nrZ6d"
											title="Discord Chat" style="padding: 0.35rem 0.25rem">
										<i class="fab fa-discord fa-fw"
										aria-hidden="true"></i>
										Discord Chat</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://kiwiirc.com/nextclient/#irc://irc.libera.chat:+6697/#sfzformat"
											title="Internet Relay Chat" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-hashtag fa-fw"
										aria-hidden="true"></i>
										IRC</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfzformat/"
											title="GitHub Organization" style="padding: 0.35rem 0.25rem">
										<i class="fab fa-github fa-fw"
										aria-hidden="true"></i>
										GitHub Organization</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="/atom.xml"
											title="News Atom Feed" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-rss fa-fw"
										aria-hidden="true"></i>
										News Atom Feed</a>
									</li>
								</ul>
							</div>
						</div>
						<div class="card mb-3">
							<div class="card-header bg-dark text-bg-dark">
								<i class="fas fa-link"
									aria-hidden="true"></i>
								Quick links
							</div>
							<div class="card-body" style="padding: 0.5rem">
								<ul class="nav nav-pills flex-column">
									<li class="nav-item">
										<a class="nav-link" href="/legacy"
											title="Old rgc:audio SFZ page" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-book fa-fw"
										aria-hidden="true"></i>
										Old rgc:audio SFZ page</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="http://www.drealm.info/sfz/"
											title="Peter L. Jones' SFZ page" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-book fa-fw"
										aria-hidden="true"></i>
										Peter L. Jones' SFZ page</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://www.kvraudio.com/forum/viewtopic.php?f=42&t=508861"
											title="KVR Forum SFZ post" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-users fa-fw"
										aria-hidden="true"></i>
										KVR Forum SFZ post</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://www.plogue.com/plgfrms/viewforum.php?f=14"
											title="Plogue Forum" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-users fa-fw"
										aria-hidden="true"></i>
										Plogue Forum</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfz/tests/"
											title="rgc:audio SFZ test suite" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-download fa-fw"
										aria-hidden="true"></i>
										rgc:audio SFZ test suite</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfz/opcode-suggestions/"
											title="Opcode suggestions" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-lightbulb fa-fw"
										aria-hidden="true"></i>
										Opcode suggestions</a>
									</li>
								</ul>
							</div>
						</div>


					</aside>
				</div>
			</div>
			<hr>
			<footer>
				<p>
					This site is open source.
					<a href="https://github.com/sfzformat/sfzformat.github.io/edit/source/tutorials/modular_instruments.md">
					Improve this page</a>
				</p>
			</footer>

		</div>
		<script src="/assets/js/scripts.min.js"></script>		<script
			src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/highlight.min.js">
		</script>
		<script
			src="https://cdn.jsdelivr.net/gh/sfz/highlight.js@master/dist/sfz.min.js">
		</script>
		<script>hljs.configure({languages:["sfz"]});hljs.highlightAll();</script>
		<script defer
			type="text/javascript"
			src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.min.js">
		</script>
		<script>
		$(document).on('click', '[data-toggle="lightbox"]', function(event) {
			event.preventDefault();
			$(this).ekkoLightbox({
				alwaysShowClose: true
			});
		});
		</script>


	</body>
</html>
